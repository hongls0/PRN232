@model MarathonManager.Web.ViewModels.HomePageViewModel
@using MarathonManager.Web.DTOs

@{
    ViewData["Title"] = "Trang chủ";
    // Lấy địa chỉ API (đã được truyền từ HomeController)
    var apiBaseUrl = ViewBag.ApiBaseUrl as string;
}

<div class="hero-section text-white text-center">
    <div class="hero-overlay"></div> <div class="container d-flex flex-column justify-content-center h-100 position-relative">
        <h1 class="display-3 fw-bold animate-fade-in-down">CHINH PHỤC MỌI ĐƯỜNG ĐUA</h1>
        <p class="lead fs-4 mb-4 animate-fade-in-up">Tìm kiếm, đăng ký và theo dõi kết quả các giải chạy marathon hàng đầu Việt Nam.</p>
        <div>
            <a asp-controller="Account" asp-action="Register" class="btn btn-primary btn-lg me-2 animate-zoom-in">
                <i class="fas fa-user-plus me-1"></i> Đăng ký ngay
            </a>
            <a href="#cac-giai-chay" class="btn btn-outline-light btn-lg animate-zoom-in">
                <i class="fas fa-running me-1"></i> Xem các giải chạy
            </a>
        </div>
    </div>
</div>

<section id="cac-giai-chay" class="py-5">
    <div class="container">
        <h2 class="section-header">Các Giải Chạy Sắp Diễn Ra</h2>

        <div class="row">
            @if (Model.FeaturedRaces == null || !Model.FeaturedRaces.Any())
            {
                <div class="col-12">
                    <div class="alert alert-info text-center" role="alert">
                        Hiện chưa có giải chạy nào được duyệt.
                    </div>
                </div>
            }
            else
            {
                @foreach (var race in Model.FeaturedRaces)
                {
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card race-card h-100">
                            <div class="ribbon"><span>@race.Status</span></div>

                            <img src="@(string.IsNullOrEmpty(race.ImageUrl) ? "https://via.placeholder.com/400x220.png?text=Race+Image" : apiBaseUrl + race.ImageUrl)"
                                 class="card-img-top" alt="@race.Name">

                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title fw-bold">@race.Name</h5>
                                <p class="card-text text-muted mb-2">
                                    <i class="fas fa-map-marker-alt me-2 text-danger"></i> @race.Location
                                </p>
                                <p class="card-text text-muted mb-3">
                                    <i class="fas fa-calendar-alt me-2 text-success"></i> @race.RaceDate.ToString("dd/MM/yyyy")
                                </p>

                                <a asp-controller="Race" asp-action="Details" asp-route-id="@race.Id" class="btn btn-outline-primary mt-auto stretched-link">
                                    <i class="fas fa-info-circle me-1"></i> Xem chi tiết
                                </a>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
    </div>
</section>

<section class="cta-section bg-primary text-white text-center py-5">
    <div class="container">
        <h2 class="display-5 fw-bold">Bắt Đầu Hành Trình Của Bạn!</h2>
        <p class="lead mb-4">Tham gia cộng đồng hàng ngàn Vận động viên. Đăng ký tài khoản ngay hôm nay.</p>
        <a asp-controller="Account" asp-action="Register" class="btn btn-light btn-lg text-primary fw-bold">
            <i class="fas fa-user-plus me-1"></i> Tạo tài khoản
        </a>
    </div>
</section>

<section id="tin-tuc" class="py-5 bg-light">
    <div class="container">
        <h2 class="section-header">Tin Tức & Sự Kiện</h2>
        <div class="row">
            @if (Model.RecentBlogPosts == null || !Model.RecentBlogPosts.Any())
            {
                <div class="col-12">
                    <div class="alert alert-info text-center" role="alert">
                        Chưa có tin tức nào được đăng.
                    </div>
                </div>
            }
            else
            {
                @foreach (var post in Model.RecentBlogPosts)
                {
                    <div class="col-md-4 mb-4">
                        <div class="card blog-card h-100">

                            <img src="@(string.IsNullOrEmpty(post.FeaturedImageUrl) ? "..." : apiBaseUrl + post.FeaturedImageUrl)"
                                 class="card-img-top" alt="@post.Title">

                            <div class="card-body">
                                <p class="card-text text-muted small">@post.CreatedAt.ToString("dd/MM/yyyy")</p>
                                <h5 class="card-title fw-bold">@post.Title</h5>
                                <p class="card-text text-muted">@post.Summary</p>
                            </div>
                            <div class="card-footer bg-white border-0 pb-3">
                                <a asp-controller="Blog" asp-action="Details" asp-route-id="@post.Id" class="btn btn-sm btn-outline-secondary stretched-link">Đọc thêm...</a>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
        <div class="text-center mt-3">
            <a asp-controller="Blog" asp-action="Index" class="btn btn-primary btn-lg">Xem tất cả Tin tức</a>
        </div>
    </div>
</section>

<section id="testimonials" class="py-5">
</section>

<section id="features" class="py-5 bg-light">
</section>